---
title: "Olympic Gymnastics EDA"
author: "WIll Gertsch"
date: "July 21, 2018"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Introduction

Gymnastics is a sport that I believe has a lot of potential for analytic. There is a decent amount of data and domain knowledge of the sport is challenging but rewarding to work with. My goal for this analysis is to explore how gymnasts have changed over the years.

## The Data

The dataset that I'm working with is <https://www.kaggle.com/heesoo37/120-years-of-olympic-history-athletes-and-results>. It comes as a csv file, so I'll just go ahead and load it from my project directory.

```{r load data}
athlete_events <- read_csv("athlete_events.csv")
```

Now that the data is loaded, let's get a general idea of what fields we are dealing with.
```{r}
head(athlete_events)
```

Now since this is an exploration of gymnastics at the Olympics, we will need to filter the data down to just gymnastics. The problem is that I have no idea what gymnastics is called in the data. I know I want to filter on the "Sport" column, but I don't know which value(s) to filter by. 
```{r}
unique(athlete_events[str_detect(athlete_events$Sport, "Gymnastics"), "Sport"])
```
We have found two sports by looking for the word "Gymnastics." We want to choose the "Gymnastics" value to filter our data since it refers to Artistic Gymnastics, which is the kind that most people think of when they think of the sport.
```{r, warning=FALSE}
gym <- filter(athlete_events, Sport=="Gymnastics")
```

Now we have the data for just gymnastics. I want to additionally prune this data to get rid of some columns we don't really need. ID should correspond to the athlete name, but some athletes may have the same name. Team and NOC basically represent the same thing, so we can drop one and just use the other. I will use the "Team" column since it is easier to understand than the NOC system. In other case, there is the issue  of names changing over time. We will need to clean that aspect up if we ever want to group by a particular country. Games and Season are not useful because gymnastics is always in the summer games and the year is taken care of by the Year column. City will not provide any useful insight because it really isn't connected to any of the other variables. Finally, Sport will also be removed because all its values are now the same.

I also changed the units used in Height and Weight from metric to imperial.
```{r}
gym <- gym[, c("ID", "Name", "Sex", "Age", "Height", "Weight", "Team", "Year", "Event", "Medal")] %>% 
  mutate(Height=round(Height*(0.0328084),1),
         Weight = round(Weight*(2.20462)))
```

Let's look at our data again.
```{r}
head(gym)
```
That looks a lot more usable!

## Plots
Now we can start getting an idea of what the data looks like visually.


### Distribution
It is helpful to get an idea of how the data is distributed.

For these kind of plots, we don't want the same athletes to show up multiple times. The solution is to make a copy of the data that only has the distinct IDs.
```{r distinct ids}
gym_distinct <- gym %>% distinct(ID, .keep_all = TRUE)
```

Now we can start plotting.
```{r sex dist}
ggplot(gym_distinct, aes(x=Sex, fill = Sex))+geom_bar()
```
There are 2,635 males and 1,499 females in total.


```{r age dist}
ggplot(gym_distinct, aes(x=Age, color = Sex))+geom_freqpoly(na.rm = TRUE, binwidth=1)
# ggplot(gym, aes(x=Age, fill=Sex))+geom_bar(na.rm=TRUE)
```

The most common age for men is 22, while the most common age for women is 16. Another interesting comparison is that, even though there are more male athletes than female athletes, there are significantly more 16 year-old women competing at the Olympic level than there are 16 year-old men. 

```{r year dist}
gym_distinct %>% 
  mutate(Year = as.character(Year)) %>% 
  ggplot(aes(x=Year, fill=Sex))+
  geom_bar(na.rm=TRUE)+
  coord_flip()
```

This plot shows that women  did not compete at the Olympic level in the sport until 1928 and then slowly rose in number relative to the male athletes until the present day where the gymnastics has close to at 50-50 male to female ratio. However, the sport seems to be getting more selective in recent years. 

There may be something wrong with the data at certain years, since some years have a huge number of athletes for the time. This is worth investigating.
```{r weird years}
years <- c(1908, 1912, 1920, 1952)
gym_strange_years <- gym_distinct %>% 
  filter(Year %in% years)
gym_strange_years %>% ggplot(aes(x=Year))+geom_bar()
```
This is a closer look at the years in question. All these years have 50+ more athletes than other years. 1908 has close to 150 more athletes than the 2016 games. 

One reason for this might be that there are more events under gymnastics than in later years.
```{r}
gym_strange_years %>% ggplot(aes(x=Year, fill = Event))+geom_histogram(binwidth=4)
```
This hypothesis proved to be partially correct. The 1908 Olympics is still massive without anything that's obviously fishy, but the 1912 and 1920 games have additional events that might be boosting the number of participants.


### Age, Height, Weight over time
Let's start by looking at the age of the athletes.

```{r age scatter, echo=FALSE, warning=FALSE}
ggplot(gym, aes(x=Year,y=Age, color=Sex))+geom_jitter()
```

This plot is not very helpful because of how bunched together the data is, even with jittering. Even so, we can get a few things out of this graph:
* Men in gymnastics seem to be older than women are.
* Athletes seem to get younger with a minimum in the 80's and then get older again.

Let's try a different plot to see if we can get more insight:
```{r age smooth plot, echo=FALSE, warning=FALSE, message=FALSE}
ggplot(gym, aes(x=Year, y=Age, color=Sex))+geom_smooth()
```

This is a much more useful graph that confirms some of the things we hypothesized earlier. It is easy to see that men are older and that athlete ages for both sexes was at a minimum in the 80's. The plot also shows that there is decent amount of variance of age recently in the sport, but overall the age for Olympians has narrowed.

We can do a similar thing for Height:
```{r height smooth plot, echo=FALSE, warning=FALSE, message=FALSE}
ggplot(gym, aes(x=Year, y=Height, color=Sex))+geom_smooth()
```

Unsurprisingly, men are taller than women on average. There also appears to be some interesting phenomenon with the variation in age. In the early days of the sport, athletes tend to be a wide range of heights. As time goes on, the average male height seems to become fairly uniform, while the women's average height is very erratic, but might become more uniform as time goes on. Let's check some variance numbers to get a better intuition for what's going on:
```{r}
var(filter(gym, Sex=="M", Year==1936)$Height, na.rm=TRUE)
var(filter(gym, Sex=="M", Year==2016)$Height, na.rm=TRUE)
var(filter(gym, Sex=="F", Year==1936)$Height, na.rm=TRUE)
var(filter(gym, Sex=="F", Year==2016)$Height, na.rm=TRUE)
```
These numbers show that our hypothesis about variance based on the graph turned out to be incorrect. For both men and women, the variance actually *increased* in 2016 compared to 1936. (Does this make sense?)

Finally, we can also plot the weight:
```{r weight smooth plot, echo=FALSE, warning=FALSE, message=FALSE}
ggplot(gym, aes(x=Year, y=Weight, color=Sex))+geom_smooth()
```

This plot looks very similar to the Height plot, probably because taller athletes will weigh more than shorted athletes.


### Correlation
```{R, warning=FALSE}
ggplot(gym, aes(x=Weight, y=Height, color=Sex))+geom_point()
```
```{r, warning=FALSE}
cor(gym$Weight, gym$Height, use="complete.obs")
```

Unsurprisingly, athlete height and weight are strongly correlated.
```{R, warning=FALSE}
ggplot(gym, aes(x=Age, y=Height, color=Sex))+geom_point()
```
```{R, warning=FALSE}
ggplot(gym, aes(x=Age, y=Weight, color=Sex))+geom_point()
```

```{r, warning=FALSE}
cor(gym$Age, gym$Height, use="complete.obs")
cor(gym$Age, gym$Weight, use="complete.obs")
```

Weight and height also have a positive correlation with age, but not as strong as height with weight.






